<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TLOU - Perfil </title>
    <link rel="icon" href="Assets/Imgs/Logo.png" type="image/x-icon">
    <link rel="stylesheet" href="CSS/dashboard.css">
    <link rel='stylesheet'
        href='https://cdn-uicons.flaticon.com/2.0.0/uicons-bold-straight/css/uicons-bold-straight.css'>
    <link rel='stylesheet'
        href='https://cdn-uicons.flaticon.com/2.0.0/uicons-solid-rounded/css/uicons-solid-rounded.css'>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/2.0.0/uicons-bold-rounded/css/uicons-bold-rounded.css'>
    <link rel='stylesheet'
        href='https://cdn-uicons.flaticon.com/2.0.0/uicons-solid-straight/css/uicons-solid-straight.css'>
    <link rel='stylesheet'
        href='https://cdn-uicons.flaticon.com/2.0.0/uicons-solid-rounded/css/uicons-solid-rounded.css'>

</head>

<body>
    <nav>
        <ul>
            <li>
                <a href="#" class="logo">
                    <img src="Assets/Imgs/Logo.png">
                    <span class="nav-item"> THE LAST OF US </span>
                </a>
            </li>
            <li><a href="#">
                    <i class="fi fi-sr-home"></i>
                    <span class="nav-item">Home</span>
                </a></li>
            <li><a href="#">
                    <i class="fi fi-sr-user"></i>
                    <span id="userName" class="nav-item">Olá,user</span>
                </a></li>
            <li><a href="sugestoes.html">
                    <i class="fi fi-sr-envelope"></i>
                    <span class="nav-item">Sugestões</span>
                </a></li>
            <li><a href="#">
                    <i class="fi fi-br-chart-histogram"></i>
                    <span class="nav-item">Analytics</span>
                </a></li>
            <li><a href="quiz.html">
                    <i class="fi fi-br-list-check"></i>
                    <span class="nav-item">Quiz</span>
                </a></li>
            <li><a href="index.html" class="logout">
                    <i class="fi fi-bs-sign-out-alt"></i>
                    <span class="nav-item">Sair</span>
                </a></li>
        </ul>
    </nav>

    <div class="kpis">
        <div class="card">
            <i class="fi fi-sr-user"></i>
            <span>Quantidade de Usuários Cadastrados</span>
            <p id="qtd_Usuarios">#</p>
        </div>
        <div class="card">
            <i id="check" class="fi fi-ss-social-network"></i>
            <span>Quantidade de Usuários Acima da Média</span>
            <p>#</p>
        </div>
        <div class="card">
            <i id="uncheck" class="fi fi-ss-hand"></i>
            <span>Quantidade de Usuários Abaixo da Média</span>
            <p>#</p>
        </div>
        <div class="card">
            <i id="medal" class="fi fi-sr-badge"></i>
            <span>Usuários com 100% de Taxa de Acerto</span>
            <p>#</p>
        </div>
    </div>

    <div class="leaderboard">
        <div class="description"><br>
            <h3>Ranking</h3><br>
            <p>Veja o Ranking dos Usuarios que acessaram o site</p><br>
            <input class="search" placeholder="Pesquisar" id="search" oninput="search()">
            <table>
                <thead>
                    <tr>
                        <td></td>
                        <td>
                            Jogador
                        </td>
                        <td>
                            Pontuação
                        </td>
                        <td>
                            Taxa de Acerto
                        </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="winner"> 1</td>
                        <td>
                            <p>José Braga</p>

                        </td>
                        <td>12</td>
                        <td>100%</td>
                    </tr>

                    <tr>
                        <td id="runner-up">2</td>
                        <td>
                            <p>Maria Simons</p>
                        </td>
                        <td>10</td>
                        <td>83%</td>
                    </tr>

                    <tr>
                        <td id="second-runner-up">3</td>
                        <td>
                            <p>Antônio Ferreira</p>
                        </td>
                        <td>9</td>
                        <td>75%</td>
                    </tr>

                    <tr>
                        <td>4</td>
                        <td>
                            <p>Ferreira da Silva</p>
                        </td>
                        <td>8</td>
                        <td>67%</td>
                    </tr>

                    <tr>
                        <td>5</td>
                        <td>
                            <p>Tom Jerry</p>
                        </td>
                        <td>8</td>
                        <td>67%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="background-image">
        <img src="Assets/Imgs/imagem_2023-11-25_180532540-removebg-preview.png" alt="Borboleta-Ellie">
    </div>

</body>

</html>
<script>
    function search() {
        var text = document.getElementById("search").value;
        const tr = document.getElementsByTagName("tr").value;
        for (let i = 1; i < tr.length; i++) {
            if (!tr[i].children[1].children[1].innerHTML.toLowerCase().includes(
                text.toLowerCase()
            )) {
                tr[i].style.display = 'none';

            }
            else {
                tr[i].style.display = '';
            }
        }
    }
</script>

<script>
    userName.innerHTML = ` Olá,  ` + sessionStorage.NOME_USUARIO;
    var qtdUsuarios = document.getElementById("qtd_Usuarios");
    var id = sessionStorage.ID_USUARIO;
    var qtdTotal = 0;
    console.log(id);

    setInterval(gerarGraficos, 3000);
    function gerarGraficos() {

        fetch(`/leaderboard/coletarQtdUsuarios?idUsuario=${id}`,
    {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                }
            })
    
    .then(res => {
                if (!res.ok) {
                    throw new Error(`Erro na solicitação: ${res.statusText}`);
                }
                return res.json();
            })
                .then(res => {
                    qtdTotal = res[0].usuariosTotal;

                    qtdUsuarios.innerHTML = `
            ${qtdTotal}
        `;
                })
                .catch(error => {
                    console.error("Erro no lado do cliente:", error);
                });
    }

</script>